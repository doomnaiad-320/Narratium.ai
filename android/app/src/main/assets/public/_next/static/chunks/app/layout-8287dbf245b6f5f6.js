(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{13296:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,19324,23)),Promise.resolve().then(a.bind(a,19046)),Promise.resolve().then(a.t.bind(a,70915,23)),Promise.resolve().then(a.t.bind(a,16793,23)),Promise.resolve().then(a.bind(a,39942)),Promise.resolve().then(a.bind(a,40448)),Promise.resolve().then(a.bind(a,49081)),Promise.resolve().then(a.bind(a,31828))},16793:()=>{},19046:(e,t,a)=>{"use strict";a.d(t,{LanguageProvider:()=>f});var o=a(95155),r=a(12115),s=a(6829);let n={zh:"font-noto-sans-sc",en:"font-source-sans"},i={zh:"font-noto-serif-sc",en:"font-source-serif"},l={zh:"font-noto-serif-sc",en:"font-cinzel"},c=e=>n[e]||"font-source-sans",d=e=>i[e]||"font-source-serif",u=e=>l[e]||"font-cinzel";var m=a(35695),p=a(50802),h=a(49081);function x(e){let{onAnimationComplete:t,redirectUrl:a,autoRedirect:s=!0}=e,{soundEnabled:n}=(0,h.y)(),[i,l]=(0,r.useState)(!1),c=(0,r.useRef)(null),d=(0,m.useRouter)(),u=(0,r.useRef)([]),x=(0,r.useRef)(null),f=(0,r.useRef)(null),g=(0,r.useRef)(null),w=(0,r.useRef)(null),b=(0,r.useRef)(null),[v,j]=(0,r.useState)(!1),y=(0,r.useRef)(null),N=(0,r.useRef)(null),k=(0,r.useRef)(null);(0,r.useEffect)(()=>{w.current&&b.current?Promise.all([new Promise(e=>{w.current&&w.current.addEventListener("canplaythrough",e,{once:!0})}),new Promise(e=>{b.current&&b.current.addEventListener("canplaythrough",e,{once:!0})})]).then(()=>{j(!0)}):j(!0)},[]),(0,r.useEffect)(()=>{if(i&&s&&a)return c.current=setTimeout(()=>{t&&t(),d.push(a)},2e3),()=>{c.current&&clearTimeout(c.current)}},[i,s,a,t,d]),(0,r.useEffect)(()=>{v&&(u.current=Array.from(document.querySelectorAll(".loading_icon path")),S())},[v,s,a]);let S=()=>{if(n&&v&&w.current){w.current.muted=!0,w.current.currentTime=0;let e=w.current.play();void 0!==e&&e.then(()=>{w.current&&(w.current.muted=!1,w.current.volume=.8)}).catch(e=>{console.log("Movement sound failed:",e)})}p.Ay.to(u.current,{stroke:"#fba53d",strokeWidth:e=>0===e?2:4,duration:.3,ease:"power1.in"});let e=p.Ay.timeline().fromTo(u.current,{strokeDashoffset:e=>480*(0!==e)},{strokeDashoffset:e=>0===e?-275:205,duration:.8,ease:"power2.inOut",onComplete:()=>{C()}});p.Ay.to(N.current,{width:"100%",duration:e.duration(),ease:"power2.inOut"}),p.Ay.to(N.current,{background:"linear-gradient(90deg, rgba(255,215,0,0.4) 0%, rgba(255,215,0,0.8) 50%, rgba(255,215,0,0.4) 100%)",boxShadow:"0 0 8px rgba(255,215,0,0.6)",duration:e.duration(),ease:"power2.inOut"}),p.Ay.to(k.current,{opacity:1,duration:.5,delay:.3,ease:"power1.out"})},C=()=>{n&&w.current&&p.Ay.to(w.current,{volume:0,duration:.5,onComplete:()=>{var e;null===(e=w.current)||void 0===e||e.pause(),w.current&&(w.current.volume=1)}}),p.Ay.timeline().to(u.current[1],{strokeWidth:0,duration:.3,ease:"power3.out"}).to(u.current[0],{strokeDasharray:"150 0 0 0 0 0 0 0 0 500",strokeDashoffset:-300,duration:.7,ease:"power3.out"},"<").to(x.current,{opacity:.9,duration:.6,ease:"power3.out",onStart:()=>{if(n&&b.current){b.current.muted=!0,b.current.currentTime=0;let e=b.current.play();void 0!==e&&e.then(()=>{b.current&&(b.current.muted=!1,b.current.volume=.2)}).catch(e=>{console.log("Completion sound failed:",e)})}},onComplete:()=>{p.Ay.to(x.current,{scale:1.03,duration:1.2,repeat:-1,yoyo:!0,ease:"sine.inOut"}),f.current&&p.Ay.to(f.current,{opacity:1,duration:.8,delay:0,ease:"power2.out",onComplete:()=>{p.Ay.to(f.current,{scale:1.05,duration:1.5,repeat:-1,yoyo:!0,ease:"sine.inOut"}),l(!0)}}),!s&&t&&t()}},"<0.3")};return(0,o.jsxs)("div",{ref:g,className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"#242020FF",overflow:"hidden"},children:[(0,o.jsx)("div",{className:"absolute inset-0 z-0 opacity-35",style:{backgroundImage:"url('/loading_yellow.png')",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),(0,o.jsx)("div",{className:"absolute inset-0 z-1 opacity-45",style:{backgroundImage:"url('/loading_red.png')",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",mixBlendMode:"multiply"}}),(0,o.jsx)("audio",{ref:w,src:"/sounds/movement.mp3",preload:"auto",playsInline:!0}),(0,o.jsx)("audio",{ref:b,src:"/sounds/completion.mp3",preload:"auto",playsInline:!0}),(0,o.jsxs)("div",{className:"loading",style:{position:"relative",width:"35rem",height:"35rem",display:"flex",justifyContent:"center",alignItems:"center",transform:"translateY(-10%)"},children:[(0,o.jsxs)("svg",{viewBox:"0 0 100 50",className:"loading_icon",style:{position:"absolute",width:"60%"},children:[(0,o.jsx)("path",{d:"M50,25c0-12.14,9.84-21.99,21.99-21.99S93.98,12.86,93.98,25s-9.84,21.99-21.99,21.99S50,37.21,50,25.06 S40.16,3.01,28.01,3.01S6.02,12.86,6.02,25s9.84,21.99,21.99,21.99S50,37.14,50,25c0-8.14,4.42-15.24,10.99-19.05 C67.57,9.76,71.99,16.86,71.99,25c0,8.14-4.42,15.24-10.99,19.04c0,0,0,0,0,0c-3.23,1.87-6.99,2.94-10.99,2.94 c-4.01,0-7.76-1.07-10.99-2.94h0C32.43,40.24,28.01,33.14,28.01,25c0-8.14,4.42-15.24,10.99-19.05l0,0 C42.24,4.08,45.99,3.01,50,3.01s7.76,1.07,10.99,2.94l0,0",style:{fill:"none",strokeLinecap:"round",strokeWidth:0,strokeDasharray:"0 5 0 5 0 5 0 5 0 500"}}),(0,o.jsx)("path",{d:"M50,25c0-12.14,9.84-21.99,21.99-21.99S93.98,12.86,93.98,25s-9.84,21.99-21.99,21.99S50,37.21,50,25.06 S40.16,3.01,28.01,3.01S6.02,12.86,6.02,25s9.84,21.99,21.99,21.99S50,37.14,50,25c0-8.14,4.42-15.24,10.99-19.05 C67.57,9.76,71.99,16.86,71.99,25c0,8.14-4.42,15.24-10.99,19.04c0,0,0,0,0,0c-3.23,1.87-6.99,2.94-10.99,2.94 c-4.01,0-7.76-1.07-10.99-2.94h0C32.43,40.24,28.01,33.14,28.01,25c0-8.14,4.42-15.24,10.99-19.05l0,0 C42.24,4.08,45.99,3.01,50,3.01s7.76,1.07,10.99,2.94l0,0",style:{fill:"none",strokeLinecap:"round",strokeWidth:0,strokeDasharray:"0 500 0 500",strokeDashoffset:480}})]}),(0,o.jsx)("div",{ref:x,className:"loading_circle",style:{position:"absolute",width:"10rem",height:"10rem",borderRadius:"100%",background:"rgba(251, 165, 61, 0.1)",border:"2px solid #fba53d",boxShadow:"0 0 15px rgba(251, 146, 60, 0.5)",opacity:0,left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),(0,o.jsx)("img",{ref:f,src:"/logo.png",className:"logo",alt:"Narratium Logo",style:{position:"absolute",width:"10rem",opacity:0,zIndex:10,left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),(0,o.jsx)("div",{ref:y,style:{position:"absolute",bottom:"25%",width:"70%",height:"8px",background:"rgba(251, 165, 61, 0.2)",borderRadius:"4px",overflow:"hidden",transform:"translate(-50%, -50%)",left:"50%",zIndex:11},children:(0,o.jsx)("div",{ref:N,style:{width:"0%",height:"100%",background:"linear-gradient(90deg, rgba(251,146,60,0.4) 0%, rgba(251,146,60,0.8) 50%, rgba(251,146,60,0.4) 100%)",boxShadow:"0 0 8px rgba(251,146,60,0.6)",borderRadius:"4px"}})}),(0,o.jsx)("p",{ref:k,style:{position:"absolute",bottom:"5%",color:"#ffd76a",fontSize:"1.2rem",fontFamily:"var(--font-cinzel)",textAlign:"center",opacity:0,zIndex:11,left:"50%",transform:"translate(-50%, -50%)",whiteSpace:"nowrap",textShadow:"0 0 5px rgba(255,215,0,0.7)"},children:"To build a time machine takes only two steps: dream it, then do it."})]})]})}function f(e){let{children:t}=e,[a,n]=(0,r.useState)(s.Nm),[i,l]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!0),[g,w]=(0,r.useState)(c(s.Nm)),[b,v]=(0,r.useState)(u(s.Nm)),[j,y]=(0,r.useState)(d(s.Nm));(0,r.useEffect)(()=>{let e=(0,s._Z)();n(e),w(c(e)),v(u(e)),y(d(e)),"undefined"!=typeof document&&document.documentElement.setAttribute("lang",e),h&&(p(!0),setTimeout(()=>{p(!1),f(!1)},3e3)),l(!0)},[h]);let N=e=>{s.Yj.includes(e)&&e!==a&&(p(!0),setTimeout(()=>{n(e),localStorage.setItem("language",e),w(c(e)),v(u(e)),y(d(e)),"undefined"!=typeof document&&document.documentElement.setAttribute("lang",e),setTimeout(()=>{p(!1)},2e3)},500))},k=e=>(0,s.sC)(a,e);return i?(0,o.jsxs)(s.sM.Provider,{value:{language:a,setLanguage:N,t:k,fontClass:g,titleFontClass:b,serifFontClass:j},children:[m&&(0,o.jsx)(x,{duration:3e3}),t]}):(0,o.jsx)(s.sM.Provider,{value:{language:a,setLanguage:N,t:k,fontClass:g,titleFontClass:b,serifFontClass:j},children:t})}},19324:()=>{},24544:(e,t,a)=>{"use strict";a.d(t,{M:()=>i});var o=a(12115),r=a(6829);let s="narratium_tour_completed",n="narratium_character_tour_completed";function i(){let[e,t]=(0,o.useState)(!1),[a,i]=(0,o.useState)([]),{t:l,language:c}=(0,r.ok)();(0,o.useEffect)(()=>{localStorage.getItem(s)||setTimeout(()=>{d()},2e3)},[]),(0,o.useEffect)(()=>{if(e){let e=a.length>0&&"body"===a[0].target;e?d():e||u()}},[c]);let d=()=>{i([{target:"body",title:"选择语言 | Choose Your Language",content:"请选择您偏好的语言 | Please select your preferred language",position:"bottom",allowSkip:!1,isLanguageSelection:!0},{target:"body",title:l("tour.welcome"),content:l("tour.welcomeDescription"),position:"bottom"},{target:"[data-tour='login-button']",title:l("tour.loginTitle"),content:l("tour.loginDescription"),position:"top"},{target:"[data-tour='settings-button']",title:l("tour.settingsTitle"),content:l("tour.settingsDescription"),position:"bottom"}]),t(!0)},u=()=>{!localStorage.getItem(n)&&(i([{target:"[data-tour='worldbook-button']",title:l("tour.worldbookTitle"),content:l("tour.worldbookDescription"),position:"bottom"},{target:"[data-tour='regex-button']",title:l("tour.regexTitle"),content:l("tour.regexDescription"),position:"bottom"},{target:"[data-tour='preset-button']",title:l("tour.presetTitle"),content:l("tour.presetDescription"),position:"bottom"},{target:"[data-tour='chat-input']",title:l("tour.chatTitle"),content:l("tour.chatDescription"),position:"top"}]),t(!0))};return{isTourVisible:e,currentTourSteps:a,startHomeTour:d,startCharacterTour:u,completeTour:()=>{t(!1),a.length>0&&"body"===a[0].target&&localStorage.setItem(s,"true")},skipTour:()=>{t(!1),a.length>0&&"body"===a[0].target&&localStorage.setItem(s,"true")},resetTour:()=>{localStorage.removeItem(s),localStorage.removeItem(n),t(!1)}}}},25014:(e,t,a)=>{"use strict";a.d(t,{JR:()=>s,Mh:()=>i,Sl:()=>o,h1:()=>r,w:()=>l});let o="G-KDEPSL9CJG",r=()=>{o&&(window.dataLayer||(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",o,{page_path:window.location.pathname,anonymize_ip:!0})))},s=e=>{o&&"function"==typeof window.gtag&&window.gtag("config",o,{page_path:e})},n=(e,t)=>{o&&"function"==typeof window.gtag&&window.gtag("event",e,t)},i=(e,t)=>{n("button_click",{button_id:e,button_name:t,context:"UserInteraction"})},l=(e,t)=>{n("form_submit",{form_id:e,form_name:t,context:"UserInteraction"})}},39942:(e,t,a)=>{"use strict";a.d(t,{default:()=>c});var o=a(95155),r=a(63554),s=a(12115),n=a(35695),i=a(25014);function l(){let e=(0,n.usePathname)(),t=(0,n.useSearchParams)();return((0,s.useEffect)(()=>{if(i.Sl){(0,i.h1)();let a=e+((null==t?void 0:t.toString())?"?".concat(t.toString()):"");(0,i.JR)(a)}},[e,t]),i.Sl)?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(r.default,{strategy:"afterInteractive",src:"https://www.googletagmanager.com/gtag/js?id=".concat(i.Sl)})}):null}function c(){return(0,o.jsx)(s.Suspense,{fallback:null,children:(0,o.jsx)(l,{})})}},40448:(e,t,a)=>{"use strict";a.d(t,{default:()=>F});var o=a(95155),r=a(12115),s=a(11518),n=a.n(s),i=a(6874),l=a.n(i),c=a(66766),d=a(35695),u=a(6829);function m(e){let{isOpen:t,toggleSidebar:a,openLoginModal:s}=e,i=(0,d.useRouter)(),[m,p]=(0,r.useState)(!1),[h,x]=(0,r.useState)(""),[f,g]=(0,r.useState)(!0),[w,b]=(0,r.useState)(!0),[v,j]=(0,r.useState)(!1),{t:y,language:N,fontClass:k}=(0,u.ok)(),[S,C]=(0,r.useState)(!1),[_,L]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{let e="true"===localStorage.getItem("isLoggedIn"),t=localStorage.getItem("username");p(e),t&&x(t)},[]),(0,r.useEffect)(()=>{if(t){let e=setTimeout(()=>C(!0),50);return()=>clearTimeout(e)}C(!1)},[t]),(0,r.useEffect)(()=>{let e=()=>{j(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),v)?null:(0,o.jsxs)("div",{className:"h-full breathing-bg magic-border text-[#d0d0d0] transition-all duration-300 ease-in-out flex flex-col ".concat(t?"w-72":"w-16"," z-50"),children:[(0,o.jsxs)("div",{className:"flex justify-between items-center h-16 py-3 px-4",children:[(0,o.jsx)("div",{className:"logo-magic-container transition-all duration-300 ease-in-out ".concat(t?"opacity-100 max-w-[200px]":"opacity-0 max-w-0"),style:{overflow:"hidden",transitionDelay:"0ms"},children:(0,o.jsxs)("div",{className:"flex items-center h-10",children:[(0,o.jsx)("div",{className:"w-[80px] h-10 flex items-center",children:(0,o.jsx)(c.default,{src:"/logo.png",alt:"Narratium",width:80,height:20,className:"object-contain"})}),(0,o.jsx)("span",{className:"ml-1 text-lg font-cinzel font-bold tracking-wider h-10 flex items-center -translate-x-3",style:{fontFamily:"var(--font-cinzel)"},children:(0,o.jsx)("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-amber-500 via-orange-400 to-yellow-300 drop-shadow-[0_0_10px_rgba(251,146,60,0.5)] font-cinzel",children:"Narratium"})})]})}),(0,o.jsx)("button",{onClick:()=>{a(),localStorage.setItem("sidebarState",t?"closed":"open"),document.documentElement.style.setProperty("--app-sidebar-width",t?"4rem":"-1rem")},className:"flex items-center justify-center text-[#f4e8c1] bg-[#1c1c1c] rounded-lg border border-[#333333] shadow-inner transition-all duration-300 hover:bg-[#252525] hover:border-[#444444] hover:text-amber-400 hover:shadow-[0_0_8px_rgba(251,146,60,0.4)] w-8 h-8","aria-label":t?"zh"===N?"收起侧边栏":"Collapse Sidebar":"zh"===N?"展开侧边栏":"Expand Sidebar",children:t?(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300",children:(0,o.jsx)("path",{d:"M15 18l-6-6 6-6"})}):(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300",children:(0,o.jsx)("path",{d:"M9 18l6-6-6-6"})})})]}),(0,o.jsx)("div",{className:"mx-2 my-1 menu-divider"}),(0,o.jsx)("nav",{className:"mt-3 flex-none px-2",children:(0,o.jsxs)("ul",{className:"space-y-1",children:[(0,o.jsx)("li",{className:"min-h-[10px]",children:(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsxs)("div",{className:"px-2 py-1 flex justify-between items-center text-xs text-[#8a8a8a] uppercase tracking-wider font-medium text-[10px] transition-all duration-300 ease-in-out overflow-hidden",style:{width:t?"auto":"0",maxWidth:t?"100%":"0",padding:t?"0.25rem 0.5rem":"0",opacity:+!!t,whiteSpace:"nowrap",transitionDelay:"0ms"},children:[(0,o.jsx)("span",{children:y("sidebar.home")}),t&&(0,o.jsx)("button",{onClick:()=>g(!f),className:"w-5 h-5 flex items-center justify-center text-[#8a8a8a] hover:text-amber-400 transition-colors duration-300 login-fantasy-bg rounded-sm","aria-label":y(f?"sidebar.collapseHome":"sidebar.expandHome"),children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300 ".concat(f?"rotate-180":""),children:(0,o.jsx)("path",{d:"M19 9l-7 7-7-7"})})})]}),(0,o.jsx)("div",{className:"overflow-hidden transition-all duration-300 ".concat(t?f?"max-h-20 opacity-100 mb-1":"max-h-0 opacity-0 mb-0":"max-h-20 opacity-100 mb-1"," mx-1"),children:(0,o.jsxs)("div",{className:"relative group",children:[(0,o.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-transparent rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t?(0,o.jsxs)(l(),{href:"/",className:"focus:outline-none group relative overflow-hidden rounded-md w-full transition-all duration-300",children:[(0,o.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/10 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,o.jsxs)("div",{className:"relative flex items-center p-2 w-full transition-all duration-300 z-10",children:[(0,o.jsx)("div",{className:"absolute inset-0 w-full h-full bg-[#333] opacity-0 group-hover:opacity-10 transition-opacity duration-300"}),(0,o.jsx)("div",{className:"absolute bottom-0 left-0 h-[1px] bg-gradient-to-r from-transparent via-[#f8d36a] to-transparent w-0 group-hover:w-full transition-all duration-500"}),(0,o.jsx)("div",{className:"w-8 h-8 flex items-center justify-center flex-shrink-0 text-[#f4e8c1] bg-[#1c1c1c] rounded-lg border border-[#333333] shadow-inner transition-all duration-300 group-hover:border-[#444444] group-hover:text-amber-400 group-hover:shadow-[0_0_8px_rgba(251,146,60,0.4)]",children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),(0,o.jsx)("polyline",{points:"9 22 9 12 15 12 15 22"})]})}),(0,o.jsx)("div",{className:"ml-2 transition-all duration-300 ease-in-out overflow-hidden",style:{transitionDelay:t?"50ms":"0ms",opacity:+!!t},children:(0,o.jsx)("span",{className:"magical-text whitespace-nowrap block text-sm group-hover:text-amber-400 transition-colors duration-300 ".concat(k),children:t&&y("sidebar.home").split("").map((e,t)=>(0,o.jsx)("span",{className:"inline-block transition-all duration-300",style:{opacity:+!!S,transform:S?"translateY(0)":"translateY(8px)",transitionDelay:"".concat(100+30*t,"ms"),width:" "===e?"0.25em":"auto"},children:e},t))})})]})]}):(0,o.jsx)(l(),{href:"/",className:"menu-item flex justify-center p-2 rounded-md cursor-pointer hover:bg-[#252525] transition-all duration-300",children:(0,o.jsx)("div",{className:"flex items-center justify-center text-[#f4e8c1] bg-[#1c1c1c] rounded-lg border border-[#333333] shadow-inner transition-all duration-300 group-hover:border-[#444444] hover:text-amber-400 hover:border-[#444444] hover:shadow-[0_0_8px_rgba(251,146,60,0.4)] w-8 h-8",children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),(0,o.jsx)("polyline",{points:"9 22 9 12 15 12 15 22"})]})})})]})})]})}),(0,o.jsx)("li",{className:"min-h-[15px]",children:(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsxs)("div",{className:"px-2 py-1 flex justify-between items-center text-xs text-[#8a8a8a] uppercase tracking-wider font-medium text-[10px] transition-all duration-300 ease-in-out overflow-hidden",style:{width:t?"auto":"0",maxWidth:t?"100%":"0",padding:t?"0.25rem 0.5rem":"0",opacity:+!!t,whiteSpace:"nowrap",transitionDelay:"0ms"},children:[(0,o.jsx)("span",{children:y("sidebar.gameArea")}),t&&(0,o.jsx)("button",{onClick:()=>b(!w),className:"w-5 h-5 flex items-center justify-center text-[#8a8a8a] hover:text-amber-400 transition-colors duration-300 login-fantasy-bg rounded-sm","aria-label":y(w?"sidebar.collapseCreation":"sidebar.expandCreation"),children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300 ".concat(w?"rotate-180":""),children:(0,o.jsx)("path",{d:"M19 9l-7 7-7-7"})})})]}),(0,o.jsx)("div",{className:"overflow-hidden transition-all duration-300 ".concat(t?w?"max-h-20 opacity-100 mt-1":"max-h-0 opacity-0 mt-0":"max-h-20 opacity-100 mt-1"," mx-1"),children:(0,o.jsxs)("div",{className:"relative group",children:[(0,o.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-transparent rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t?(0,o.jsxs)(l(),{href:"/character-cards",className:"focus:outline-none group relative overflow-hidden rounded-md w-full transition-all duration-300",children:[(0,o.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/10 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,o.jsxs)("div",{className:"relative flex items-center p-2 w-full transition-all duration-300 z-10",children:[(0,o.jsx)("div",{className:"absolute inset-0 w-full h-full bg-[#333] opacity-0 group-hover:opacity-10 transition-opacity duration-300"}),(0,o.jsx)("div",{className:"absolute bottom-0 left-0 h-[1px] bg-gradient-to-r from-transparent via-[#f8d36a] to-transparent w-0 group-hover:w-full transition-all duration-500"}),(0,o.jsx)("div",{className:"w-8 h-8 flex items-center justify-center flex-shrink-0 text-[#f4e8c1] bg-[#1c1c1c] rounded-lg border border-[#333333] shadow-inner transition-all duration-300 group-hover:border-[#444444] group-hover:text-amber-400 group-hover:shadow-[0_0_8px_rgba(251,146,60,0.4)]",children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300",children:[(0,o.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,o.jsx)("circle",{cx:"12",cy:"7",r:"4"})]})}),(0,o.jsx)("div",{className:"ml-2 transition-all duration-300 ease-in-out overflow-hidden",style:{transitionDelay:t?"50ms":"0ms",opacity:+!!t},children:(0,o.jsx)("span",{className:"magical-text whitespace-nowrap block text-sm group-hover:text-amber-400 transition-colors duration-300 ".concat(k),children:t&&y("sidebar.characterCards").split("").map((e,t)=>(0,o.jsx)("span",{className:"inline-block transition-all duration-300",style:{opacity:+!!S,transform:S?"translateY(0)":"translateY(8px)",transitionDelay:"".concat(200+30*t,"ms"),width:" "===e?"0.25em":"auto"},children:e},t))})})]})]}):(0,o.jsx)(l(),{href:"/character-cards",className:"menu-item flex justify-center p-2 rounded-md cursor-pointer hover:bg-[#252525] transition-all duration-300",children:(0,o.jsx)("div",{className:"flex items-center justify-center text-[#f4e8c1] bg-[#1c1c1c] rounded-lg border border-[#333333] shadow-inner transition-all duration-300 group-hover:border-[#444444] hover:text-amber-400 hover:border-[#444444] hover:shadow-[0_0_8px_rgba(251,146,60,0.4)] w-8 h-8",children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300",children:[(0,o.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,o.jsx)("circle",{cx:"12",cy:"7",r:"4"})]})})})]})})]})}),(0,o.jsx)("li",{className:"min-h-[15px]",children:(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsxs)("div",{className:"px-2 py-1 flex justify-between items-center text-xs text-[#8a8a8a] uppercase tracking-wider font-medium text-[10px] transition-all duration-300 ease-in-out overflow-hidden",style:{width:t?"auto":"0",maxWidth:t?"100%":"0",padding:t?"0.25rem 0.5rem":"0",opacity:+!!t,whiteSpace:"nowrap",transitionDelay:"0ms"},children:[(0,o.jsx)("span",{children:y("sidebar.creationArea")}),t&&(0,o.jsx)("button",{onClick:()=>L(!_),className:"w-5 h-5 flex items-center justify-center text-[#8a8a8a] hover:text-amber-400 transition-colors duration-300 login-fantasy-bg rounded-sm","aria-label":y(_?"sidebar.collapseCreation":"sidebar.expandCreation"),children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300 ".concat(_?"rotate-180":""),children:(0,o.jsx)("path",{d:"M19 9l-7 7-7-7"})})})]}),(0,o.jsx)("div",{className:"overflow-hidden transition-all duration-300 ".concat(t?_?"max-h-20 opacity-100 mt-1":"max-h-0 opacity-0 mt-0":"max-h-20 opacity-100 mt-1"," mx-1"),children:(0,o.jsxs)("div",{className:"relative group mt-1",children:[(0,o.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-transparent rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t?(0,o.jsxs)(l(),{href:"/creator-input",className:"focus:outline-none group relative overflow-hidden rounded-md w-full transition-all duration-300",children:[(0,o.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/10 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,o.jsxs)("div",{className:"relative flex items-center p-2 w-full transition-all duration-300 z-10",children:[(0,o.jsx)("div",{className:"absolute inset-0 w-full h-full bg-[#333] opacity-0 group-hover:opacity-10 transition-opacity duration-300"}),(0,o.jsx)("div",{className:"absolute bottom-0 left-0 h-[1px] bg-gradient-to-r from-transparent via-[#f8d36a] to-transparent w-0 group-hover:w-full transition-all duration-500"}),(0,o.jsx)("div",{className:"w-8 h-8 flex items-center justify-center flex-shrink-0 text-[#f4e8c1] bg-[#1c1c1c] rounded-lg border border-[#333333] shadow-inner transition-all duration-300 group-hover:border-[#444444] group-hover:text-amber-400 group-hover:shadow-[0_0_8px_rgba(251,146,60,0.4)]",children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300",children:[(0,o.jsx)("path",{d:"M9 18h6"}),(0,o.jsx)("path",{d:"M10 22h4"}),(0,o.jsx)("path",{d:"M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"}),(0,o.jsx)("path",{d:"M12 2v1"}),(0,o.jsx)("path",{d:"M3.05 11.05l.76.76"}),(0,o.jsx)("path",{d:"M20.95 11.05l-.76.76"})]})}),(0,o.jsx)("div",{className:"ml-2 transition-all duration-300 ease-in-out overflow-hidden",style:{transitionDelay:t?"50ms":"0ms",opacity:+!!t},children:(0,o.jsx)("span",{className:"magical-text whitespace-nowrap block text-sm group-hover:text-amber-400 transition-colors duration-300 ".concat(k),children:t&&y("sidebar.creator").split("").map((e,t)=>(0,o.jsx)("span",{className:"inline-block transition-all duration-300",style:{opacity:+!!S,transform:S?"translateY(0)":"translateY(8px)",transitionDelay:"".concat(200+30*t,"ms"),width:" "===e?"0.25em":"auto"},children:e},t))})})]})]}):(0,o.jsx)(l(),{href:"/creator-input",className:"menu-item flex justify-center p-2 rounded-md cursor-pointer hover:bg-[#252525] transition-all duration-300",children:(0,o.jsx)("div",{className:"flex items-center justify-center text-[#f4e8c1] bg-[#1c1c1c] rounded-lg border border-[#333333] shadow-inner transition-all duration-300 group-hover:border-[#444444] hover:text-amber-400 hover:border-[#444444] hover:shadow-[0_0_8px_rgba(251,146,60,0.4)] w-8 h-8",children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300",children:[(0,o.jsx)("path",{d:"M9 18h6"}),(0,o.jsx)("path",{d:"M10 22h4"}),(0,o.jsx)("path",{d:"M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"}),(0,o.jsx)("path",{d:"M12 2v1"}),(0,o.jsx)("path",{d:"M3.05 11.05l.76.76"}),(0,o.jsx)("path",{d:"M20.95 11.05l-.76.76"})]})})})]})})]})})]})}),(0,o.jsxs)("div",{className:"jsx-238d27cc241827e3 relative mt-auto pt-4 px-2 mb-3 transition-all duration-300 overflow-hidden group/footer",children:[(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute top-0 left-0 right-0 h-[0.5px] bg-gradient-to-r from-transparent via-[#f8d36a] to-transparent opacity-70"}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute top-0 left-0 right-0 h-[0.5px] bg-gradient-to-r from-transparent via-[#f8d36a] to-transparent opacity-40 blur-[1px] translate-y-[0.5px]"}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute top-0 left-1/4 right-1/4 h-[0.5px] bg-[#f8d36a] opacity-20 blur-[2px] translate-y-[1px]"}),(0,o.jsx)("div",{style:{left:"-10%",animation:"moveRight 3s ease-in-out infinite"},className:"jsx-238d27cc241827e3 absolute top-[-1px] w-8 h-[2px] bg-gradient-to-r from-transparent via-[#ffd76a] to-transparent opacity-0 group-hover/footer:opacity-80 blur-[1px] transition-all duration-500 ease-in-out"}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute top-0 left-1/4 h-[2px] w-[2px] rounded-full bg-[#ffd76a] opacity-0 group-hover/footer:opacity-90 transition-opacity duration-500 delay-100"}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute top-0 left-2/4 h-[2px] w-[2px] rounded-full bg-[#ffd76a] opacity-0 group-hover/footer:opacity-90 transition-opacity duration-500 delay-300"}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute top-0 left-3/4 h-[2px] w-[2px] rounded-full bg-[#ffd76a] opacity-0 group-hover/footer:opacity-90 transition-opacity duration-500 delay-500"}),(0,o.jsx)(n(),{id:"238d27cc241827e3",children:"@-webkit-keyframes moveRight{0%{-webkit-transform:translatex(0);transform:translatex(0)}100%{-webkit-transform:translatex(-webkit-calc(100vw));transform:translatex(-webkit-calc(100vw));transform:translatex(calc(100vw))}}@-moz-keyframes moveRight{0%{-moz-transform:translatex(0);transform:translatex(0)}100%{-moz-transform:translatex(-moz-calc(100vw));transform:translatex(-moz-calc(100vw));transform:translatex(calc(100vw))}}@-o-keyframes moveRight{0%{-o-transform:translatex(0);transform:translatex(0)}100%{-o-transform:translatex(calc(100vw));transform:translatex(calc(100vw))}}@keyframes moveRight{0%{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0)}100%{-webkit-transform:translatex(-webkit-calc(100vw));-moz-transform:translatex(-moz-calc(100vw));-o-transform:translatex(calc(100vw));transform:translatex(-webkit-calc(100vw));transform:translatex(-moz-calc(100vw));transform:translatex(calc(100vw))}}"}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 mb-2",children:m?(0,o.jsxs)("button",{onClick:()=>{localStorage.removeItem("isLoggedIn"),localStorage.removeItem("username"),localStorage.removeItem("userId"),p(!1),i.push("/")},className:"jsx-238d27cc241827e3 "+"focus:outline-none group relative overflow-hidden rounded-md w-full transition-all duration-300 ".concat(t?"py-1.5 px-2 flex items-center justify-center":"p-2 flex justify-center"," cursor-pointer"),children:[(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute inset-0 bg-gradient-to-br from-[#242424]/0 to-[#1a1a1a]/0 opacity-0 group-hover:opacity-80 transition-opacity duration-300"}),(0,o.jsxs)("div",{className:"jsx-238d27cc241827e3 relative flex items-center justify-center w-full transition-all duration-300 z-10",children:[(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 "+"".concat(t?"w-6 h-6":"w-8 h-8"," flex items-center justify-center flex-shrink-0 text-[#f8d36a] group-hover:text-[#ffc107] transition-colors duration-300 "),children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t?"14":"16",height:t?"14":"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-238d27cc241827e3 transition-transform duration-300 group-hover:scale-110",children:[(0,o.jsx)("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",className:"jsx-238d27cc241827e3"}),(0,o.jsx)("polyline",{points:"16 17 21 12 16 7",className:"jsx-238d27cc241827e3"}),(0,o.jsx)("line",{x1:"21",y1:"12",x2:"9",y2:"12",className:"jsx-238d27cc241827e3"})]})}),t&&(0,o.jsxs)("div",{style:{transitionDelay:t?"50ms":"0ms",opacity:+!!t},className:"jsx-238d27cc241827e3 ml-2 transition-all duration-300 ease-in-out overflow-hidden",children:[(0,o.jsx)("div",{className:"jsx-238d27cc241827e3",children:(0,o.jsx)("span",{className:"jsx-238d27cc241827e3 "+"magical-text whitespace-nowrap block text-xs font-medium bg-clip-text text-transparent bg-gradient-to-r from-[#f8d36a] to-[#ffc107] ".concat(k),children:t&&h.split("").map((e,t)=>(0,o.jsx)("span",{style:{opacity:+!!S,transform:S?"translateY(0)":"translateY(8px)",transitionDelay:"".concat(250+30*t,"ms"),width:" "===e?"0.25em":"auto"},className:"jsx-238d27cc241827e3 inline-block transition-all duration-300",children:e},t))})}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 mt-1",children:(0,o.jsx)("span",{className:"jsx-238d27cc241827e3 "+"magical-text whitespace-nowrap block text-xs font-medium bg-clip-text text-transparent bg-gradient-to-r from-[#f8d36a] to-[#ffc107] ".concat(k),children:t&&y("sidebar.logout").split("").map((e,t)=>(0,o.jsx)("span",{style:{opacity:+!!S,transform:S?"translateY(0)":"translateY(8px)",transitionDelay:"".concat(250+30*t,"ms"),width:" "===e?"0.25em":"auto"},className:"jsx-238d27cc241827e3 inline-block transition-all duration-300",children:e},t))})})]})]}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute inset-0 w-full h-full bg-[#333] opacity-0 group-hover:opacity-10 transition-opacity duration-300"}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute bottom-0 left-0 h-[1px] bg-gradient-to-r from-transparent via-[#f8d36a] to-transparent w-0 group-hover:w-full transition-all duration-500"})]}):(0,o.jsxs)("button",{onClick:s,"data-tour":"login-button",className:"jsx-238d27cc241827e3 "+"focus:outline-none group relative overflow-hidden rounded-md w-full transition-all duration-300 ".concat(t?"py-1.5 px-2 flex items-center justify-center":"p-2 flex justify-center"," cursor-pointer"),children:[(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute inset-0 bg-gradient-to-br from-[#242424]/0 to-[#1a1a1a]/0 opacity-0 group-hover:opacity-80 transition-opacity duration-300"}),(0,o.jsxs)("div",{className:"jsx-238d27cc241827e3 relative flex items-center justify-center w-full transition-all duration-300 z-10",children:[(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 "+"".concat(t?"w-6 h-6":"w-8 h-8"," flex items-center justify-center flex-shrink-0 text-[#f8d36a] group-hover:text-[#ffc107] transition-colors duration-300"),children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t?"14":"16",height:t?"14":"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-238d27cc241827e3 transition-transform duration-300 group-hover:scale-110",children:[(0,o.jsx)("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",className:"jsx-238d27cc241827e3"}),(0,o.jsx)("polyline",{points:"10 17 15 12 10 7",className:"jsx-238d27cc241827e3"}),(0,o.jsx)("line",{x1:"15",y1:"12",x2:"3",y2:"12",className:"jsx-238d27cc241827e3"})]})}),t&&(0,o.jsx)("div",{style:{transitionDelay:t?"50ms":"0ms",opacity:+!!t},className:"jsx-238d27cc241827e3 ml-2 transition-all duration-300 ease-in-out overflow-hidden",children:(0,o.jsx)("span",{className:"jsx-238d27cc241827e3 "+"magical-text whitespace-nowrap block text-xs font-medium bg-clip-text text-transparent bg-gradient-to-r from-[#f8d36a] to-[#ffc107] ".concat(k),children:t&&y("sidebar.nologin").split("").map((e,t)=>(0,o.jsx)("span",{style:{opacity:+!!S,transform:S?"translateY(0)":"translateY(8px)",transitionDelay:"".concat(250+30*t,"ms"),width:" "===e?"0.25em":"auto"},className:"jsx-238d27cc241827e3 inline-block transition-all duration-300",children:e},t))})})]}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute inset-0 w-full h-full bg-[#333] opacity-0 group-hover:opacity-10 transition-opacity duration-300"}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute bottom-0 left-0 h-[1px] bg-gradient-to-r from-transparent via-[#f8d36a] to-transparent w-0 group-hover:w-full transition-all duration-500"})]})}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3",children:(0,o.jsxs)("a",{href:"https://github.com/Narratium/Narratium.ai",target:"_blank",rel:"noopener noreferrer",className:"jsx-238d27cc241827e3 "+"focus:outline-none group relative overflow-hidden rounded-md w-full transition-all duration-300 ".concat(t?"py-1.5 px-2 flex items-center justify-center":"p-2 flex justify-center"),children:[(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute inset-0 bg-gradient-to-br from-[#242424]/0 to-[#1a1a1a]/0 opacity-0 group-hover:opacity-80 transition-opacity duration-300"}),(0,o.jsxs)("div",{className:"jsx-238d27cc241827e3 relative flex items-center justify-center transition-all duration-300 z-10",children:[(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 "+"".concat(t?"w-6 h-6":"w-8 h-8"," flex items-center justify-center flex-shrink-0 text-[#f8d36a] group-hover:text-[#ffc107] transition-colors duration-300"),children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t?"14":"16",height:t?"14":"16",viewBox:"0 0 24 24",fill:"currentColor",className:"jsx-238d27cc241827e3 transition-transform duration-300 group-hover:scale-110",children:(0,o.jsx)("path",{d:"M12 .297c-6.63 0-12 5.373-12 12 0 5.303  3.438 9.8 8.205 11.387.6.113.82-.258.82-.577  0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.416-4.042-1.416  -.546-1.387-1.333-1.757-1.333-1.757-1.09-.745.084-.729.084-.729  1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.304  3.495.997.108-.776.418-1.305.76-1.605-2.665-.3-5.466-1.334-5.466-5.93  0-1.31.468-2.38 1.236-3.22-.124-.303-.536-1.523.117-3.176  0 0 1.008-.322 3.3 1.23a11.52 11.52 0 013.003-.404c1.018.005 2.045.138 3.003.404  2.29-1.552 3.295-1.23 3.295-1.23.655 1.653.243 2.873.12 3.176  .77.84 1.234 1.91 1.234 3.22 0 4.61-2.807 5.625-5.48 5.92.43.37.823 1.096.823 2.21  0 1.595-.015 2.88-.015 3.27 0 .32.216.694.825.576  C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12",className:"jsx-238d27cc241827e3"})})}),t&&(0,o.jsx)("div",{style:{transitionDelay:t?"50ms":"0ms",opacity:+!!t},className:"jsx-238d27cc241827e3 ml-2 transition-all duration-300 ease-in-out overflow-hidden",children:(0,o.jsx)("span",{className:"jsx-238d27cc241827e3 "+"magical-text whitespace-nowrap block text-xs font-medium bg-clip-text text-transparent bg-gradient-to-r from-[#f8d36a] to-[#ffc107] ".concat(k),children:t&&"Star us on GitHub".split("").map((e,t)=>(0,o.jsx)("span",{style:{opacity:+!!S,transform:S?"translateY(0)":"translateY(8px)",transitionDelay:"".concat(250+30*t,"ms"),width:" "===e?"0.25em":"auto"},className:"jsx-238d27cc241827e3 inline-block transition-all duration-300",children:e},t))})})]}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute inset-0 w-full h-full bg-[#333] opacity-0 group-hover:opacity-10 transition-opacity duration-300"}),(0,o.jsx)("div",{className:"jsx-238d27cc241827e3 absolute bottom-0 left-0 h-[1px] bg-gradient-to-r from-transparent via-[#f8d36a] to-transparent w-0 group-hover:w-full transition-all duration-500"})]})})]})]})}a(58104);var p=a(25014),h=a(34399),x=a(70978);function f(e){let{isOpen:t,toggleSidebar:a}=e,{t:s,fontClass:n,serifFontClass:i}=(0,u.ok)(),[l,c]=(0,r.useState)([]),[d,m]=(0,r.useState)(""),[f,g]=(0,r.useState)(!1),[w,b]=(0,r.useState)(""),[v,j]=(0,r.useState)(""),[y,N]=(0,r.useState)(!0),[k,S]=(0,r.useState)("openai"),[C,_]=(0,r.useState)(""),[L,M]=(0,r.useState)(""),[I,P]=(0,r.useState)(""),[E,z]=(0,r.useState)([]),[A,T]=(0,r.useState)(!1),[B,D]=(0,r.useState)(!1),[O,R]=(0,r.useState)(!1),[W,U]=(0,r.useState)(!1),[F,H]=(0,r.useState)(!1),[G,Y]=(0,r.useState)(!1),[K,J]=(0,r.useState)(!1);(0,r.useEffect)(()=>{var e;let t=localStorage.getItem("apiConfigs"),a=[];if(t)try{a=JSON.parse(t)}catch(e){console.error("Error parsing saved API configs",e)}let o=localStorage.getItem("activeConfigId"),r=o&&a.some(e=>e.id===o)?o:(null===(e=a[0])||void 0===e?void 0:e.id)||"";c(a),m(r),a.length>0&&V(a.find(e=>e.id===r))},[]);let V=e=>{S(e.type),_(e.baseUrl),M(e.model),P(e.apiKey||""),e.baseUrl&&e.apiKey&&ea(e.baseUrl,e.apiKey)},q=()=>"api_".concat(Date.now()),Q=()=>{S("openai"),_(""),M(""),P(""),g(!0),m("")},Z=()=>{if(g(!1),l.length>0&&d){let e=l.find(e=>e.id===d);e?V(e):(m(l[0].id),V(l[0]))}else l.length>0&&(m(l[0].id),V(l[0]))},$=()=>{if(f){let e=X(k,L),t={id:q(),name:e,type:k,baseUrl:C,model:L,apiKey:"openai"===k?I:void 0},a=[...Array.isArray(l)?l:[],t];c(a),m(t.id),g(!1),localStorage.setItem("apiConfigs",JSON.stringify(a)),localStorage.setItem("activeConfigId",t.id),T(!0),setTimeout(()=>{T(!1)},2e3);return}{if(!Array.isArray(l)){c([]),console.error("Configs is not an array",l);return}let e=l.map(e=>e.id===d?{...e,type:k,baseUrl:C,model:L,apiKey:"openai"===k?I:void 0}:e);c(e),localStorage.setItem("apiConfigs",JSON.stringify(e))}localStorage.setItem("llmType",k),localStorage.setItem("openai"===k?"openaiBaseUrl":"ollamaBaseUrl",C),localStorage.setItem("openai"===k?"openaiModel":"ollamaModel",L),"openai"===k&&(localStorage.setItem("openaiApiKey",I),localStorage.setItem("apiKey",I)),localStorage.setItem("modelBaseUrl",C),localStorage.setItem("modelName",L),f||(T(!0),setTimeout(()=>{T(!1)},2e3))},X=(e,t)=>{let a=Array.isArray(l)?l:[],o=t&&t.trim()?t:"openai"===e?"OpenAI":"Ollama";o.length>15&&(o=o.substring(0,15));let r=a.filter(e=>e.model===t||new RegExp("【\\d+】".concat(o)).test(e.name));if(0===r.length)return"【1】".concat(o);let s=0;return r.forEach(e=>{let t=e.name.match(/【(\d+)】/);if(t&&t[1]){let e=parseInt(t[1],10);!isNaN(e)&&e>s&&(s=e)}}),"【".concat(s+1,"】").concat(o)},ee=e=>{let t=l.filter(t=>t.id!==e);c(t),e===d&&(t.length>0?(m(t[0].id),V(t[0])):(m(""),S("openai"),_(""),M(""),P(""))),localStorage.setItem("apiConfigs",JSON.stringify(t)),e===d&&localStorage.setItem("activeConfigId",t.length>0?t[0].id:"")},et=e=>{if(e===d)return;m(e);let t=l.find(t=>t.id===e);t&&(V(t),localStorage.setItem("activeConfigId",e),g(!1))},ea=async(e,t)=>{if("ollama"!==k)try{var a;let o=await fetch("".concat(e,"/models"),{headers:{Authorization:"Bearer ".concat(t)}}),r=await o.json(),s=(null===(a=r.data)||void 0===a?void 0:a.map(e=>e.id))||[];z(s),J(0===s.length),D(!0),setTimeout(()=>D(!1),2e3)}catch(e){R(!0),J(!0),setTimeout(()=>R(!1),2e3)}},eo=(e,t)=>{t.stopPropagation(),b(e.id),j(e.name),N(!1)},er=()=>{if(!v.trim())return;let e=l.map(e=>e.id===w?{...e,name:v.trim()}:e);c(e),localStorage.setItem("apiConfigs",JSON.stringify(e)),b("")},es=e=>{"Enter"===e.key?er():"Escape"===e.key&&b("")},en=async()=>{if(C&&L){Y(!0),U(!1),H(!1);try{let e="openai"===k?new h.Db({modelName:L,openAIApiKey:I,configuration:{baseURL:C}}):new x.PH({baseUrl:C,model:L});if((await e.invoke([{role:"system",content:"You are a helpful AI assistant."},{role:"user",content:"Hello, this is a test message. Please respond with 'Test successful' if you can read this."}])).content.toString().toLowerCase().includes("test successful"))U(!0),setTimeout(()=>U(!1),2e3);else throw Error("Invalid response content")}catch(e){console.error("Test failed:",e),H(!0),setTimeout(()=>H(!1),2e3)}finally{Y(!1)}}};return(0,o.jsx)("div",{className:"h-full magic-border border-l border-[#534741] breathing-bg text-[#d0d0d0] transition-all duration-300 overflow-hidden ".concat(t?"w-64":"w-0"),children:(0,o.jsxs)("div",{className:"w-64 h-full ".concat(t?"opacity-100":"opacity-0"," transition-opacity duration-300 overflow-y-auto fantasy-scrollbar"),children:[(0,o.jsxs)("div",{className:"flex justify-between items-center p-3 border-b border-[#534741] bg-gradient-to-r from-[#1a1a1a] to-[#2a2a2a]",children:[(0,o.jsx)("h1",{className:"text-base magical-text ".concat(i),children:s("modelSettings.title")}),(0,o.jsx)("button",{onClick:()=>{(0,p.Mh)("ModelSidebar","关闭模型设置"),a()},className:"w-6 h-6 flex items-center justify-center text-[#f4e8c1] bg-[#1c1c1c] rounded-md border border-[#333333] shadow-inner transition-all duration-300 hover:bg-[#252525] hover:border-[#444444] hover:text-amber-400 hover:shadow-[0_0_8px_rgba(251,146,60,0.4)]",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300",children:(0,o.jsx)("path",{d:"M9 18l6-6-6-6"})})})]}),(0,o.jsxs)("div",{className:"p-3",children:[(0,o.jsxs)("div",{className:"mb-3",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,o.jsx)("label",{className:"text-[#f4e8c1] text-xs font-medium ".concat(n),children:s("modelSettings.configurations")||"API Configurations"}),(0,o.jsxs)("button",{onClick:e=>{(0,p.Mh)("ModelSidebar","创建新配置"),Q()},className:"text-xs text-[#d1a35c] hover:text-[#f4e8c1] transition-all duration-200 px-2 py-1 rounded border border-[#534741] hover:border-[#d1a35c] hover:shadow-[0_0_6px_rgba(209,163,92,0.2)] flex items-center gap-1",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M12 5v14M5 12h14"})}),s("modelSettings.newConfig")||"New Config"]})]}),l.length>0&&(0,o.jsx)("div",{className:"mb-3 flex flex-col gap-1.5 max-h-50 overflow-y-auto fantasy-scrollbar pr-1",children:l.map((e,t)=>(0,o.jsxs)("div",{className:"flex items-center justify-between p-1.5 rounded-md cursor-pointer text-sm transition-all duration-200 group ".concat(d===e.id?"bg-[#3a3632] border border-[#d1a35c] shadow-[0_0_8px_rgba(209,163,92,0.2)]":"bg-[#292929] hover:bg-[#333333] border border-transparent hover:border-[#534741]"),onClick:()=>et(e.id),children:[(0,o.jsx)("div",{className:"relative flex items-center flex-1 min-w-0 group/name",children:w===e.id?(0,o.jsx)("input",{type:"text",value:v,onChange:e=>j(e.target.value),onBlur:er,onKeyDown:es,className:"bg-[#1c1c1c] border border-[#534741] rounded py-0.5 px-1 text-xs text-[#f4e8c1] w-full focus:border-[#d1a35c] focus:outline-none",onClick:e=>e.stopPropagation(),autoFocus:!0}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"text-xs truncate cursor-text hover:text-[#f4e8c1] transition-colors",onDoubleClick:t=>eo(e,t),children:e.name}),y&&(0,o.jsx)("span",{className:"absolute ".concat(0===t?"top-full mt-1":"-top-6"," left-0 z-20 bg-[#2a2522] text-[#d1a35c] text-[10px] px-2 py-1 rounded border border-[#d1a35c] whitespace-nowrap opacity-0 group-hover/name:opacity-100 transition-all duration-200 pointer-events-none shadow-[0_0_8px_rgba(209,163,92,0.2)]"),children:s("modelSettings.doubleClickToEditName")}),(0,o.jsx)("span",{className:"ml-2 text-xs text-[#8a8a8a] px-1.5 py-0.5 rounded bg-[#1c1c1c] border border-[#333333] flex-shrink-0",children:e.type})]})}),(0,o.jsx)("button",{onClick:t=>{(0,p.Mh)("ModelSidebar","删除配置"),t.stopPropagation(),ee(e.id)},className:"text-red-400 hover:text-red-300 text-xs p-1 opacity-0 group-hover:opacity-100 transition-opacity ml-1 flex-shrink-0",children:"\xd7"})]},e.id))})]}),!f&&d&&(0,o.jsxs)("div",{className:"border border-[#534741] rounded-md p-2.5 mb-3 bg-[#1c1c1c] bg-opacity-50 backdrop-blur-sm",children:[(0,o.jsxs)("div",{className:"mb-1.5",children:[(0,o.jsxs)("span",{className:"text-xs text-[#8a8a8a]",children:[s("modelSettings.llmType")||"API Type",":"]}),(0,o.jsx)("span",{className:"ml-2 text-xs text-[#f4e8c1]",children:"openai"===k?"OpenAI API":"Ollama API"})]}),(0,o.jsxs)("div",{className:"mb-1.5",children:[(0,o.jsxs)("span",{className:"text-xs text-[#8a8a8a]",children:[s("modelSettings.baseUrl")||"Base URL",":"]}),(0,o.jsx)("span",{className:"ml-2 text-xs text-[#f4e8c1] break-all",children:C.includes("://")?"http://api-server/v1":C})]}),"openai"===k&&(0,o.jsxs)("div",{className:"mb-1.5",children:[(0,o.jsxs)("span",{className:"text-xs text-[#8a8a8a]",children:[s("modelSettings.apiKey")||"API Key",":"]}),(0,o.jsx)("span",{className:"ml-2 text-xs text-[#f4e8c1]",children:"•".repeat(Math.min(10,I.length))})]}),(0,o.jsxs)("div",{className:"mb-1.5",children:[(0,o.jsxs)("label",{className:"text-xs text-[#8a8a8a] mr-2",children:[s("modelSettings.model")||"Model",":"]}),"openai"!==k||K?(0,o.jsx)("input",{type:"text",value:L,onChange:e=>{let t=e.target.value;M(t);let a=l.map(e=>e.id===d?{...e,model:t}:e);c(a),localStorage.setItem("apiConfigs",JSON.stringify(a)),localStorage.setItem("openai"===k?"openaiModel":"ollamaModel",t),localStorage.setItem("modelName",t),T(!0),setTimeout(()=>T(!1),2e3)},className:"bg-[#292929] border border-[#534741] rounded py-0.5 px-1.5 text-[#f4e8c1] text-xs max-w-[200px] focus:border-[#d1a35c] focus:outline-none transition-colors",placeholder:"openai"===k?"gpt-4-turbo, claude-3-opus-20240229...":"llama3, mistral, mixtral..."}):(0,o.jsxs)("select",{value:L,onChange:e=>{let t=e.target.value;M(t);let a=l.map(e=>e.id===d?{...e,model:t}:e);c(a),localStorage.setItem("apiConfigs",JSON.stringify(a)),localStorage.setItem("openai"===k?"openaiModel":"ollamaModel",t),localStorage.setItem("modelName",t),T(!0),setTimeout(()=>T(!1),2e3)},className:"bg-[#292929] border border-[#534741] rounded py-0.5 px-1.5 text-[#f4e8c1] text-xs max-w-[200px] truncate focus:border-[#d1a35c] focus:outline-none transition-colors",style:{textOverflow:"ellipsis"},children:[(0,o.jsx)("option",{value:"",disabled:!0,className:"truncate",children:s("modelSettings.selectModel")||"Select a model..."}),E.map(e=>(0,o.jsx)("option",{value:e,className:"truncate",children:e},e))]})]})]}),f&&(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block text-[#f4e8c1] text-xs font-medium mb-2 ".concat(n),children:s("modelSettings.llmType")||"API Type"}),(0,o.jsxs)("select",{value:k,onChange:e=>{S(e.target.value)},className:"w-full bg-[#292929] border border-[#534741] rounded py-1.5 px-2 text-xs text-[#d0d0d0] leading-tight focus:outline-none focus:border-[#d1a35c] transition-colors",children:[(0,o.jsx)("option",{value:"openai",children:"OpenAI API"}),(0,o.jsx)("option",{value:"ollama",children:"Ollama API"})]})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"baseUrl",className:"block text-[#f4e8c1] text-xs font-medium mb-2 ".concat(n),children:s("modelSettings.baseUrl")}),(0,o.jsx)("input",{type:"text",id:"baseUrl",className:"bg-[#292929] border border-[#534741] rounded w-full py-1.5 px-2 text-xs text-[#d0d0d0] leading-tight focus:outline-none focus:border-[#d1a35c] transition-colors",placeholder:"openai"===k?"https://api.openai.com/v1":"http://localhost:11434",value:C,onChange:e=>_(e.target.value)})]}),"openai"===k&&(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"apiKey",className:"block text-[#f4e8c1] text-xs font-medium mb-2 ".concat(n),children:s("modelSettings.apiKey")||"API Key"}),(0,o.jsx)("input",{type:"text",id:"apiKey",className:"bg-[#292929] border border-[#534741] rounded w-full py-1.5 px-2 text-xs text-[#d0d0d0] leading-tight focus:outline-none focus:border-[#d1a35c] transition-colors",placeholder:"sk-...",value:I,onChange:e=>P(e.target.value)})]}),(0,o.jsx)("div",{className:"mb-4",children:(0,o.jsxs)("div",{className:"relative",children:["openai"===k&&(0,o.jsx)("button",{className:"bg-[#3e3a3a] hover:bg-[#534741] text-[#f4e8c1] font-normal py-1.5 px-2 text-xs rounded-md border border-[#d1a35c] w-full transition-colors magical-text ".concat(n),onClick:()=>ea(C,I),children:s("modelSettings.getModelList")||"Get Model List"}),B&&(0,o.jsx)("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-[#333333] bg-opacity-80 rounded transition-opacity",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500 mr-2 animate-pulse",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(0,o.jsx)("span",{className:"text-white text-xs ".concat(n),children:s("modelSettings.getModelListSuccess")||"Get Model List Success"})]})}),O&&(0,o.jsx)("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-[#333333] bg-opacity-80 rounded transition-opacity",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-red-500 mr-2 animate-pulse",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),(0,o.jsx)("span",{className:"text-white text-xs ".concat(n),children:s("modelSettings.getModelListError")||"Get Model List Error"})]})})]})}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"model",className:"block text-[#f4e8c1] text-xs font-medium mb-2 ".concat(n),children:s("modelSettings.model")}),(0,o.jsx)("input",{type:"text",id:"model",className:"bg-[#292929] border border-[#534741] rounded w-full py-1.5 px-2 text-xs text-[#d0d0d0] leading-tight focus:outline-none focus:border-[#d1a35c] transition-colors",placeholder:"openai"===k?"gpt-4-turbo, claude-3-opus-20240229...":"llama3, mistral, mixtral...",value:L,onChange:e=>M(e.target.value)}),"openai"===k&&(0,o.jsxs)("div",{className:"mt-2 text-xs text-[#8a8a8a]",children:[(0,o.jsx)("p",{className:"mb-1 ".concat(n),children:s("modelSettings.modelList")||"Model List"}),(0,o.jsxs)("select",{value:L,onChange:e=>{(0,p.Mh)("ModelSidebar",s("modelSettings.selectModel")||"Select a model..."),M(e.target.value)},className:"w-full bg-[#292929] border border-[#534741] rounded py-2 px-3 text-[#d0d0d0] text-sm leading-tight focus:outline-none focus:border-[#d1a35c] transition-colors",children:[(0,o.jsx)("option",{value:"",disabled:!0,className:"text-[#8a8a8a]",children:s("modelSettings.selectModel")||"Select a model..."}),E.map(e=>(0,o.jsx)("option",{value:e,className:"bg-[#292929] text-[#d0d0d0]",children:e},e))]})]})]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("button",{onClick:e=>{(0,p.Mh)("ModelSidebar","创建配置"),e.stopPropagation(),$()},className:"flex-1 bg-[#3e3a3a] hover:bg-[#534741] text-[#f4e8c1] font-medium py-1.5 px-2 text-xs rounded border border-[#d1a35c] transition-colors magical-text ".concat(n),children:s("modelSettings.createConfig")||"Create Configuration"}),(0,o.jsx)("button",{onClick:()=>{(0,p.Mh)("cancel_create_config_btn","取消创建配置"),Z()},className:"px-2 py-1.5 bg-[#292929] text-xs text-[#d0d0d0] rounded border border-[#534741] hover:bg-[#333333] transition-colors ".concat(n),children:s("common.cancel")||"Cancel"})]})]}),!f&&d&&(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("button",{onClick:e=>{(0,p.Mh)("ModelSidebar","保存配置"),e.stopPropagation(),$()},className:"bg-[#3e3a3a] hover:bg-[#534741] text-[#f4e8c1] font-normal py-1.5 px-2 text-xs rounded-md border border-[#d1a35c] w-full transition-all duration-200 hover:shadow-[0_0_8px_rgba(209,163,92,0.2)] ".concat(n),children:s("modelSettings.saveSettings")||"Save Settings"}),A&&(0,o.jsx)("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-[#333333] bg-opacity-80 rounded transition-opacity backdrop-blur-sm",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(0,o.jsx)("span",{className:"text-white text-xs ".concat(n),children:s("modelSettings.settingsSaved")||"Settings Saved"})]})})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("button",{onClick:e=>{(0,p.Mh)("ModelSidebar","测试模型"),e.stopPropagation(),en()},disabled:G||!C||!L,className:"bg-[#3e3a3a] hover:bg-[#534741] text-[#f4e8c1] font-normal py-1.5 px-2 text-xs rounded-md border border-[#d1a35c] w-full transition-all duration-200 hover:shadow-[0_0_8px_rgba(209,163,92,0.2)] ".concat(n," disabled:opacity-50 disabled:cursor-not-allowed"),children:G?(0,o.jsxs)("span",{className:"flex items-center justify-center",children:[(0,o.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-3 w-3 text-[#f4e8c1]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s("modelSettings.testing")||"Testing..."]}):s("modelSettings.testModel")||"Test Model"}),W&&(0,o.jsx)("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-[#333333] bg-opacity-80 rounded transition-opacity backdrop-blur-sm",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(0,o.jsx)("span",{className:"text-white text-xs ".concat(n),children:s("modelSettings.testSuccess")||"Model test successful"})]})}),F&&(0,o.jsx)("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-[#333333] bg-opacity-80 rounded transition-opacity backdrop-blur-sm",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-red-500 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),(0,o.jsx)("span",{className:"text-white text-xs ".concat(n),children:s("modelSettings.testError")||"Model test failed"})]})})]})]}),0===l.length&&!f&&(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center py-3",children:[(0,o.jsx)("p",{className:"text-xs text-[#8a8a8a] mb-2",children:s("modelSettings.noConfigs")||"No API configurations yet"}),(0,o.jsxs)("button",{onClick:e=>{(0,p.Mh)("ModelSidebar","创建第一个配置"),e.stopPropagation(),Q()},className:"bg-[#3e3a3a] hover:bg-[#534741] text-[#f4e8c1] font-normal py-1.5 px-2 text-xs rounded border border-[#d1a35c] transition-all duration-200 hover:shadow-[0_0_8px_rgba(209,163,92,0.2)] ".concat(n," flex items-center justify-center gap-1 w-full max-w-[200px]"),children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M12 5v14M5 12h14"})}),s("modelSettings.createFirstConfig")||"Create Your First Configuration"]})]})]})]})})}var g=a(49081),w=a(24544),b=a(93362);async function v(){try{let e=await (0,b.uv)(),t=JSON.stringify(e);return new Blob([t],{type:"application/json"})}catch(e){throw console.error("Export failed:",e),Error("Export failed")}}async function j(e){try{let t=await e.text(),a=JSON.parse(t);await (0,b.Jt)(a)}catch(e){throw console.error("Import failed:",e),Error("Import failed")}}function y(){let e=new Date;return"narratium-backup-".concat(e.toISOString().split("T")[0],"_").concat(e.getTime(),".json")}async function N(e,t){var a;return(null==t?void 0:t.headers)||(t.headers={}),(null===(a=t.headers)||void 0===a?void 0:a.Authorization)||(t.headers.Authorization="Bearer "+localStorage.getItem("google_drive_token")),fetch(e,t).then(async e=>{if(401===e.status){console.log("令牌过期！");let e=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:S,client_secret:C,refresh_token:localStorage.getItem("google_drive_refresh_token"),grant_type:"refresh_token"})}).then(e=>e.json());console.log("data====>",e),localStorage.setItem("google_drive_token",e.access_token)}return e.json()})}var k=a(49509);let S=k.env.GOOGLE_OAUTH_CLIENT_ID||"",C=k.env.GOOGLE_OAUTH_CLIENT_SECRET||"",_=k.env.GOOGLE_OAUTH_REDIRECT_URI||"https://www.narratium.org/oauth2callback";function L(e,t){let a=new URL(e);for(let e in t)a.searchParams.append(e,t[e]);return a.toString()}function M(){return L("https://accounts.google.com/o/oauth2/v2/auth",{client_id:S,redirect_uri:_,response_type:"code",scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent"})}async function I(e){let{search:t}=e;if(t){let e=(t.replace("?","").split("&")||[]).reduce((e,t)=>{let[a,o]=t.split("=");return a&&(e[a]=o),e},{});if(e.code)try{var a;let t=await (a=e.code,fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({code:a,client_id:S,client_secret:C,redirect_uri:_,grant_type:"authorization_code"})}).then(e=>e.json()));(null==t?void 0:t.access_token)?(localStorage.setItem("google_drive_token",t.access_token),localStorage.setItem("google_drive_refresh_token",t.refresh_token),window.location.replace(window.location.origin),alert("Google 授权成功！请再次导出数据至谷歌！")):console.error("Get Google token Error")}catch(e){console.error("Get Google token Error:",e),alert("获取授权失败，请重试！")}}}async function P(e){let t=new FormData,a={name:e.filename,parents:[e.folderId]},o=new File([e.blob],e.filename,{type:"application/json"});t.append("metadata",new Blob([JSON.stringify(a)],{type:"application/json"})),t.append("file",o),await N("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",body:t})}async function E(){let e=L("https://www.googleapis.com/drive/v3/files",{pageSize:"10",fields:"files(id, name, mimeType, createdTime)",q:"mimeType='application/vnd.google-apps.folder' and name = 'NarratiumBackup'"}),t=await N(e,{});return t.files.length?t.files[0]:await z()}async function z(){return await N("https://www.googleapis.com/drive/v3/files",{method:"POST",body:JSON.stringify({name:"NarratiumBackup",mimeType:"application/vnd.google-apps.folder",parents:["root"]})})}async function A(e){var t;let a=L("https://www.googleapis.com/drive/v3/files",{q:"'".concat(e,"' in parents"),fields:"files(id, name, mimeType, modifiedTime, size, webViewLink)",pageSize:"10",orderBy:"createdTime desc"}),o=await N(a,{});return(null==o?void 0:null===(t=o.files)||void 0===t?void 0:t[0])?new File([await fetch("https://www.googleapis.com/drive/v3/files/".concat(o.files[0].id,"?alt=media"),{headers:{Authorization:"Bearer "+localStorage.getItem("google_drive_token")}}).then(e=>e.blob())],"backup.json",{type:"application/json"}):(alert("没有备份文件，请先导出数据！"),!1)}function T(e){let{toggleModelSidebar:t}=e,[a,s]=(0,r.useState)(!1),n=(0,r.useRef)(null),{language:i,setLanguage:l,t:c}=(0,u.ok)(),{soundEnabled:d,toggleSound:m}=(0,g.y)(),{resetTour:p}=(0,w.M)();(0,r.useEffect)(()=>{function e(e){n.current&&!n.current.contains(e.target)&&s(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let h=async()=>{try{let e=await v(),t=y();!function(e,t){let a=URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}(e,t),s(!1)}catch(e){console.error("Export failed:",e),alert(c("common.exportFailed"))}},x=async()=>{try{let e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&(await j(a),s(!1),window.location.reload())},e.click()}catch(e){console.error("Import failed:",e),alert(c("common.importFailed"))}};async function f(){if(localStorage.getItem("google_drive_token")){let e=await E();if(null==e?void 0:e.id){let t=await A(e.id);t&&(await j(t),s(!1),alert("导入成功！"),window.location.reload())}}else{let e=M();window.location.href=e}}async function b(){if(localStorage.getItem("google_drive_token")){let e=await v(),t=y(),a=await E();(null==a?void 0:a.id)&&(await P({blob:e,filename:t,folderId:a.id}),alert("上传成功"))}else{let e=M();window.location.href=e}}let N=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{N.current||(N.current=!0,I(window.location))},[]),(0,o.jsxs)("div",{className:"relative",ref:n,children:[(0,o.jsx)("button",{onClick:()=>s(!a),"data-tour":"settings-button",className:"w-8 h-8 flex items-center justify-center text-[#f4e8c1] bg-[#1c1c1c] rounded-lg border border-[#333333] shadow-inner transition-all duration-300 hover:bg-[#252525] hover:border-[#444444] hover:text-amber-400 hover:shadow-[0_0_8px_rgba(251,146,60,0.4)]","aria-label":c("common.settings"),"aria-expanded":a,children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"transition-transform duration-300 ".concat(a?"rotate-90":""),children:[(0,o.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,o.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a&&(0,o.jsx)("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-[#1c1c1c] border border-[#333333] z-50 overflow-hidden",children:(0,o.jsxs)("div",{className:"py-1",children:[(0,o.jsxs)("button",{onClick:()=>{let e="zh"===i?"en":"zh";l(e),document.documentElement.lang=e},className:"flex items-center w-full px-4 py-2 text-sm text-[#f4e8c1] hover:bg-[#252525] transition-colors",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,o.jsx)("path",{d:"M5 8l6 6"}),(0,o.jsx)("path",{d:"M4 14l6-6 2-3"}),(0,o.jsx)("path",{d:"M2 5h12"}),(0,o.jsx)("path",{d:"M7 2h1"}),(0,o.jsx)("path",{d:"M22 22l-5-10-5 10"}),(0,o.jsx)("path",{d:"M14 18h6"})]}),"zh"===i?c("common.switchToEnglish"):c("common.switchToChinese")]}),(0,o.jsxs)("button",{onClick:()=>{t(),s(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-[#f4e8c1] hover:bg-[#252525] transition-colors",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,o.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,o.jsx)("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),(0,o.jsx)("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}),c("modelSettings.title")]}),(0,o.jsxs)("button",{onClick:m,className:"flex items-center w-full px-4 py-2 text-sm text-[#f4e8c1] hover:bg-[#252525] transition-colors",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:d?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),(0,o.jsx)("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"}),(0,o.jsx)("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),(0,o.jsx)("line",{x1:"23",y1:"9",x2:"17",y2:"15"}),(0,o.jsx)("line",{x1:"17",y1:"9",x2:"23",y2:"15"})]})}),d?c("common.soundOff"):c("common.soundOn")]}),(0,o.jsxs)("button",{onClick:()=>{p(),s(!1),window.location.reload()},className:"flex items-center w-full px-4 py-2 text-sm text-[#f4e8c1] hover:bg-[#252525] transition-colors",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,o.jsx)("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),(0,o.jsx)("path",{d:"M21 3v5h-5"}),(0,o.jsx)("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),(0,o.jsx)("path",{d:"M3 21v-5h5"})]}),c("tour.resetTour")]}),(0,o.jsx)("div",{className:"border-t border-[#333333] my-1"}),(0,o.jsxs)("button",{onClick:h,className:"flex items-center w-full px-4 py-2 text-sm text-[#f4e8c1] hover:bg-[#252525] transition-colors",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,o.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,o.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,o.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),c("common.exportData")]}),(0,o.jsxs)("button",{onClick:x,className:"flex items-center w-full px-4 py-2 text-sm text-[#f4e8c1] hover:bg-[#252525] transition-colors",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,o.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,o.jsx)("polyline",{points:"17 8 12 3 7 8"}),(0,o.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),c("common.importData")]}),(0,o.jsxs)("button",{onClick:b,className:"flex items-center w-full px-4 py-2 text-sm text-[#f4e8c1] hover:bg-[#252525] transition-colors",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,o.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,o.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,o.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),c("common.exportDataToGoogle")]}),(0,o.jsxs)("button",{onClick:f,className:"flex items-center w-full px-4 py-2 text-sm text-[#f4e8c1] hover:bg-[#252525] transition-colors",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,o.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,o.jsx)("polyline",{points:"17 8 12 3 7 8"}),(0,o.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),c("common.importDataFromGoogle")]})]})})]})}var B=a(60760),D=a(76408);function O(e){let{isOpen:t,onClose:a}=e,{t:s,fontClass:n,titleFontClass:i,serifFontClass:l}=(0,u.ok)(),[c,d]=(0,r.useState)("password"),[m,p]=(0,r.useState)(""),[h,x]=(0,r.useState)(""),[f,g]=(0,r.useState)(""),[w,b]=(0,r.useState)(!1),[v,j]=(0,r.useState)(""),[y,N]=(0,r.useState)(1),[k,S]=(0,r.useState)(!0),C=(0,r.useRef)(null),_=(0,r.useRef)(null);(0,r.useEffect)(()=>{t&&_.current&&_.current.focus()},[t,y,k]),(0,r.useEffect)(()=>{let e=e=>{C.current&&!C.current.contains(e.target)&&a()},o=e=>{"Escape"===e.key&&a()};return t&&(document.addEventListener("mousedown",e),document.addEventListener("keydown",o)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",o)}},[t,a]);let L=[{id:1,text:s("auth.wizardQuestion").replace("邮箱","名称"),placeholder:s("auth.emailPlaceholder").replace("邮箱","名称")},{id:2,text:s("password"===c?"auth.spellQuestion":"auth.codeQuestion"),placeholder:s("password"===c?"auth.passwordPlaceholder":"auth.codePlaceholder")}],M=L.find(e=>e.id===y)||L[0],I=e=>{"Enter"===e.key&&(e.preventDefault(),""!==m.trim()&&E(e))},P=e=>{let{value:t}=e.target;switch(y){case 1:p(t);break;case 2:"password"===c?x(t):g(t)}},E=async e=>{if(e.preventDefault(),m.trim()){b(!0),j("");try{let e=Math.floor(1e4*Math.random()).toString();localStorage.setItem("username",m),localStorage.setItem("userId",e),localStorage.setItem("isLoggedIn","true"),a(),N(1),p(""),x(""),g(""),window.location.reload()}catch(e){console.error("Login error:",e),j("登录失败，请重试")}finally{b(!1)}}};return(0,o.jsx)(B.N,{children:t&&(0,o.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[(0,o.jsx)(D.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 backdrop-blur-sm",onClick:a}),(0,o.jsxs)(D.P.div,{ref:C,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",damping:20,stiffness:300},className:"fantasy-bg bg-opacity-75 border border-[#534741] rounded-lg shadow-lg p-8 w-full max-w-md relative z-10 backdrop-filter backdrop-blur-sm",children:[(0,o.jsx)("button",{onClick:a,className:"absolute top-4 right-4 text-[#a18d6f] hover:text-[#f9c86d] transition-colors",children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,o.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),(0,o.jsxs)("div",{className:"text-center mb-6",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-[#f9c86d] mb-2 font-cinzel",children:"Welcome Back"}),(0,o.jsx)("p",{className:"text-[#c0a480] ".concat(l),children:s("auth.continueJourney")})]}),v&&(0,o.jsx)(D.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-[#a18d6f] text-sm text-center mb-4",children:v}),(0,o.jsxs)("form",{onSubmit:E,className:"w-full",children:[(0,o.jsx)(B.N,{mode:"wait",children:k&&(0,o.jsxs)(D.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.4,ease:"easeOut"},className:"text-center",children:[(0,o.jsx)("h2",{className:"text-xl magical-login-text mb-8 tracking-wide ".concat(l),dangerouslySetInnerHTML:{__html:M.text.replace("✨","<span>✨</span>").replace("\uD83D\uDD2E","<span>\uD83D\uDD2E</span>").replace("⚡","<span>⚡</span>")}}),(0,o.jsxs)("div",{className:"magical-input min-h-[100px] flex items-center justify-center",children:[(()=>{let e=M.placeholder;return(0,o.jsxs)("div",{className:"relative w-full",children:[(0,o.jsx)("input",{ref:_,type:2===y&&"password"===c?"password":"text",className:"bg-transparent border-0 outline-none w-full text-center text-lg text-[#eae6db] placeholder-[#a18d6f] shadow-none focus:ring-0 focus:border-0 ".concat(l),placeholder:e,value:1===y?m:"password"===c?h:f,onChange:P,onKeyDown:I,disabled:w,autoComplete:"off",style:{caretColor:"#f9c86d",caretShape:"bar",background:"transparent",boxShadow:"none",border:"none",borderWidth:"0",borderColor:"transparent",letterSpacing:"0.05em"}}),(0,o.jsx)("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-32 h-0.5 opacity-0 group-focus-within:opacity-100 transition-opacity duration-300",children:(0,o.jsx)("div",{className:"w-full h-full bg-gradient-to-r from-transparent via-[#c0a480] to-transparent"})})]})})(),(0,o.jsx)("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-32 h-1 opacity-0 transition-opacity duration-300 magical-input-glow"})]}),2===y&&"code"===c&&(0,o.jsx)(D.P.button,{initial:{opacity:0},animate:{opacity:1},type:"button",className:"mt-4 portal-button text-sm ".concat(n),onClick:()=>{if(!m.trim()){j("请输入名称");return}},children:s("auth.getCode")}),w&&(0,o.jsxs)(D.P.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-8 text-[#c0a480] ".concat(l),children:[(0,o.jsx)("span",{className:"inline-block animate-pulse",children:"✨"})," ",s("auth.openingMagicDoor")]})]},"question-".concat(y,"-").concat(c))}),(0,o.jsxs)("div",{className:"text-center mt-8 text-xs text-[#a18d6f] ".concat(n),children:[(0,o.jsx)("p",{children:s("auth.agreementText")}),(0,o.jsxs)("div",{className:"flex justify-center space-x-2 mt-1",children:[(0,o.jsx)("a",{href:"#",className:"text-[#c0a480] hover:text-[#f9c86d] transition-colors",children:s("auth.termsOfService")}),(0,o.jsx)("span",{children:"•"}),(0,o.jsx)("a",{href:"#",className:"text-[#c0a480] hover:text-[#f9c86d] transition-colors",children:s("auth.privacyPolicy")})]})]}),(0,o.jsx)("div",{className:"flex justify-center mt-8",children:(0,o.jsxs)("div",{className:"flex space-x-4",children:[(0,o.jsx)("button",{type:"button",className:"w-10 h-10 rounded-full flex items-center justify-center border border-[#333333] bg-[#1a1a1a] hover:bg-[#252525] transition-colors",children:(0,o.jsx)("svg",{className:"w-5 h-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{d:"M12.545 10.239v3.821h5.445c-.712 2.315-2.647 3.972-5.445 3.972a6.033 6.033 0 110-12.064c1.498 0 2.866.549 3.921 1.453l2.814-2.814A9.969 9.969 0 0012.545 2C7.021 2 2.543 6.477 2.543 12s4.478 10 10.002 10c8.396 0 10.249-7.85 9.426-11.748l-9.426-.013z"})})}),(0,o.jsx)("button",{type:"button",className:"w-10 h-10 rounded-full flex items-center justify-center border border-[#333333] bg-[#1a1a1a] hover:bg-[#252525] transition-colors",children:(0,o.jsx)("svg",{className:"w-5 h-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{d:"M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 14-7.503 14-14 0-.21-.005-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"})})}),(0,o.jsx)("button",{type:"button",className:"w-10 h-10 rounded-full flex items-center justify-center border border-[#333333] bg-[#1a1a1a] hover:bg-[#252525] transition-colors",children:(0,o.jsx)("svg",{className:"w-5 h-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})})]})})]})]})]})})}var R=a(6267);class W{static isNative(){try{return R.Ii.isNativePlatform()}catch(e){return!1}}static getPlatform(){try{return R.Ii.getPlatform()}catch(e){return"web"}}static isIOS(){try{return"ios"===R.Ii.getPlatform()}catch(e){return!1}}static isAndroid(){try{return"android"===R.Ii.getPlatform()}catch(e){return!1}}static isWeb(){try{return"web"===R.Ii.getPlatform()}catch(e){return!0}}static isMobile(){return!!this.isNative()||window.innerWidth<768}static getPlatformConfig(){let e=this.getPlatform(),t=this.isNative();return{platform:e,isNative:t,isMobile:this.isMobile(),isIOS:this.isIOS(),isAndroid:this.isAndroid(),isWeb:this.isWeb(),features:{biometricAuth:t,pushNotifications:t,fileSystem:t,camera:t,statusBar:t,splashScreen:t}}}static logPlatformInfo(){console.log("\uD83D\uDD0D Platform Detection:",this.getPlatformConfig())}}class U{static async initialize(){if(!this.initialized&&W.isNative())try{let{App:e}=await a.e(931).then(a.bind(a,28931)),{SplashScreen:t}=await a.e(296).then(a.bind(a,57296)),{StatusBar:o,Style:r}=await a.e(60).then(a.bind(a,80060));await this.configureStatusBar(o,r),this.setupAppStateListeners(e),await this.hideSplashScreen(t),this.initialized=!0,console.log("✅ Capacitor app initialized successfully")}catch(e){console.error("❌ Failed to initialize Capacitor app:",e)}}static async configureStatusBar(e,t){try{await e.setStyle({style:t.Dark}),W.isAndroid()&&await e.setBackgroundColor({color:"#ffffff"}),console.log("\uD83D\uDCF1 Status bar configured")}catch(e){console.error("Failed to configure status bar:",e)}}static setupAppStateListeners(e){try{e.addListener("appStateChange",e=>{let{isActive:t}=e;console.log("\uD83D\uDCF1 App state changed. Is active: ".concat(t)),t?this.onAppResume():this.onAppPause()}),e.addListener("appUrlOpen",e=>{console.log("\uD83D\uDD17 App opened via URL:",e.url),this.handleDeepLink(e.url)}),e.addListener("backButton",e=>{let{canGoBack:t}=e;console.log("⬅️ Back button pressed, can go back:",t),this.handleBackButton(t)}),console.log("\uD83D\uDC42 App state listeners configured")}catch(e){console.error("Failed to setup app state listeners:",e)}}static async hideSplashScreen(e){try{await new Promise(e=>setTimeout(e,1e3)),await e.hide(),console.log("\uD83C\uDFA8 Splash screen hidden")}catch(e){console.error("Failed to hide splash screen:",e)}}static onAppResume(){console.log("\uD83D\uDD04 App resumed - refreshing data"),window.dispatchEvent(new CustomEvent("app-resume"))}static onAppPause(){console.log("⏸️ App paused - saving state"),window.dispatchEvent(new CustomEvent("app-pause"))}static handleDeepLink(e){try{let t=new URL(e).pathname;console.log("\uD83D\uDD17 Handling deep link:",t),window.history&&(window.history.pushState({},"",t),window.dispatchEvent(new PopStateEvent("popstate")))}catch(e){console.error("Failed to handle deep link:",e)}}static handleBackButton(e){e?window.history&&window.history.back():this.handleAppExit()}static async handleAppExit(){try{if(confirm("确定要退出 Narratium 吗？")){let{App:e}=await a.e(931).then(a.bind(a,28931));await e.exitApp()}}catch(e){console.error("Failed to handle app exit:",e)}}static async getAppInfo(){if(!W.isNative())return{name:"Narratium",version:"1.0.0",build:"web"};try{let{App:e}=await a.e(931).then(a.bind(a,28931));return await e.getInfo()}catch(e){return console.error("Failed to get app info:",e),null}}}U.initialized=!1;function F(e){let{children:t}=e,[a,s]=(0,r.useState)(!0),[n,i]=(0,r.useState)(!1),[l,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)(!1),[x,g]=(0,r.useState)(!1),[w,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=()=>{h(window.innerWidth<768||W.isMobile())};return(async()=>{await U.initialize();let e=W.getPlatformConfig();b(e),g(e.isNative),u(!0)})(),e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let v=()=>{i(!n)};return d?(0,o.jsxs)("div",{className:"flex h-full overflow-hidden fantasy-bg relative ".concat(x?"native-app":""),children:[x&&(0,o.jsx)("div",{className:"status-bar-spacer"}),(0,o.jsx)(O,{isOpen:l,onClose:()=>c(!1)}),(0,o.jsx)("div",{className:"fixed left-0 top-0 h-full z-10",children:(0,o.jsx)(m,{isOpen:a,toggleSidebar:()=>{s(!a)},openLoginModal:()=>c(!0)})}),(0,o.jsx)("main",{className:"flex-1 h-full overflow-auto transition-all duration-300\n            ".concat(p?"ml-0":a?"ml-72":"ml-0","\n            ").concat(n?"mr-64":"mr-0","\n          "),children:(0,o.jsxs)("div",{className:"h-full relative",children:[(0,o.jsx)("div",{className:"absolute top-4 right-4 z-[999]",children:(0,o.jsx)(T,{toggleModelSidebar:v})}),t]})}),(0,o.jsx)("div",{className:"fixed right-0 top-0 h-full z-40",children:(0,o.jsx)(f,{isOpen:n,toggleSidebar:v})}),!1]}):null}},49081:(e,t,a)=>{"use strict";a.d(t,{SoundProvider:()=>i,y:()=>n});var o=a(95155),r=a(12115);let s=(0,r.createContext)(void 0);function n(){let e=(0,r.useContext)(s);if(void 0===e)throw Error("useSoundContext must be used within a SoundProvider");return e}function i(e){let{children:t}=e,[a,n]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{{let e=localStorage.getItem("soundEnabled");null!==e&&n("true"===e)}},[]),(0,o.jsx)(s.Provider,{value:{soundEnabled:a,toggleSound:()=>{let e=!a;n(e),localStorage.setItem("soundEnabled",String(e))}},children:t})}},58104:()=>{},70915:()=>{},93362:(e,t,a)=>{"use strict";a.d(t,{CZ:()=>i,Jt:()=>g,Mr:()=>u,UI:()=>o,Vx:()=>r,aU:()=>p,j$:()=>x,qW:()=>h,rH:()=>l,uv:()=>f,v3:()=>d,w5:()=>n});let o="characters_record",r="character_dialogues",s="character_images",n="world_book",i="regex_scripts",l="preset_data";function c(){return new Promise((e,t)=>{let a=indexedDB.open("CharacterAppDB",4);a.onerror=()=>t(a.error),a.onsuccess=()=>e(a.result),a.onupgradeneeded=()=>{let e=a.result;e.objectStoreNames.contains(o)||e.createObjectStore(o),e.objectStoreNames.contains(r)||e.createObjectStore(r),e.objectStoreNames.contains(s)||e.createObjectStore(s),e.objectStoreNames.contains(n)||e.createObjectStore(n),e.objectStoreNames.contains(i)||e.createObjectStore(i),e.objectStoreNames.contains(l)||e.createObjectStore(l)}})}async function d(e){await m();let t=await c();return new Promise((a,o)=>{let r=t.transaction(e,"readonly").objectStore(e).get("data");r.onsuccess=()=>a(r.result||[]),r.onerror=()=>o(r.error)})}async function u(e,t){await m();let a=await c();return new Promise((o,r)=>{let s=a.transaction(e,"readwrite").objectStore(e).put(t,"data");s.onsuccess=()=>o(),s.onerror=()=>r(s.error)})}async function m(){let e=await c(),t=[o,r,s,n,l,i];await Promise.all(t.map(t=>new Promise((a,o)=>{let r=e.transaction(t,"readwrite").objectStore(t),s=r.get("data");s.onsuccess=()=>{if(void 0===s.result){let e=r.put([],"data");e.onsuccess=()=>a(),e.onerror=()=>o(e.error)}else a()},s.onerror=()=>o(s.error)})))}async function p(e,t){await m();let a=await c();return new Promise((o,r)=>{let n=a.transaction(s,"readwrite").objectStore(s).put(t,e);n.onsuccess=()=>o(),n.onerror=()=>r(n.error)})}async function h(e){await m();let t=await c();return new Promise((a,o)=>{let r=t.transaction(s,"readonly").objectStore(s).get(e);r.onsuccess=()=>a(r.result||null),r.onerror=()=>o(r.error)})}async function x(e){await m();let t=await c();return new Promise((a,o)=>{let r=t.transaction(s,"readwrite").objectStore(s).delete(e);r.onsuccess=()=>a(),r.onerror=()=>o(r.error)})}async function f(){let e=await c(),t={};for(let e of[o,r,n,i]){let a=await d(e);t[e]=a}await d(s);let a=[],l=e.transaction(s,"readonly").objectStore(s);for(let e of(await new Promise(e=>{let t=l.getAllKeys();t.onsuccess=()=>e(t.result)}))){let t=await h(e);if(t&&t instanceof Blob)try{let o=await w(t);a.push({key:e,data:o})}catch(t){console.error("Failed to convert image ".concat(e," to base64:"),t)}}return t[s]=a,t}async function g(e){for(let t of(await c(),[o,r,n,i]))e[t]&&await u(t,e[t]);if(e[s]){for(let t of e[s])if("string"==typeof t.data){let e=await b(t.data);await p(t.key,e)}}}async function w(e){if(!(e instanceof Blob))throw Error("Input is not a valid Blob object");return new Promise((t,a)=>{let o=new FileReader;o.onloadend=()=>{"string"==typeof o.result?t(o.result):a(Error("Failed to convert blob to base64"))},o.onerror=a,o.readAsDataURL(e)})}async function b(e){return(await fetch(e)).blob()}}},e=>{var t=t=>e(e.s=t);e.O(0,[533,433,297,592,408,874,613,303,770,829,441,684,358],()=>t(13296)),_N_E=e.O()}]);